) %>%
select(PlayId, WindSpeed, WindDirection)
?left_join
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection) %>%
select(PlayId, WindSpeed, WindDirection)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDire) %>%
select(PlayId, WindSpeed, WindDirection)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection) %>%
select(PlayId, WindSpeed, WindDirection)
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
df[df$WindSpeed %in% c("E", "SE", "SSW")] = dfDirSpeed
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
df[df$WindSpeed %in% c("E", "SE", "SSW")] = dfDirSpeed
df$WindSpeed %in% c("E", "SE", "SSW")
df[df$WindSpeed %in% c("E", "SE", "SSW"),] = dfDirSpeed
table(df$WindSpeed)
df %>%
mutate(
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer()
) %>%
select(WindSpeed) %>%
table()
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
table(dfDirSpeed$WindSpeed)
df = loadData()
table(df$WindSpeed)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
# select(WindSpeed, WindDirection) %>%
select(WindDirection) %>%
table()
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
table(dfDirSpeed$WindSpeed)
df %>%
filter(WindDirection =="Calm") %>%
select(WindSpeed)
table(df$WindSpeed)
table(df$WindDirection)
df %>%
filter(WindDirection == "Calm") %>%
select(WindSpeed)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
# select(WindSpeed, WindDirection) %>%
select(WindDirection) %>%
table()
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
table(dfDirSpeed$WindSpeed)
df[df$WindSpeed %in% c("E", "SE", "SSW"),] = dfDirSpeed
table(df$WindSpeed)
table(df$WindDirection)
df[df$WindDirection == "Calm"] = 0
df[df$WindDirection == "Calm", ] = 0
df %>%
mutate(
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer()
) %>%
select(WindSpeed) %>%
table()
teamAbbreviations = c(BAL = "BLT", CLE = "CLV", ARI = "ARZ", HOU = "HST")
?fwrite
library(knitr)
opts_chunk$set(echo = TRUE,
collapse = FALSE,
comment = "",
strip.white = TRUE,
warning = FALSE,
message = FALSE,
out.width = "70%",
fig.align = "center")
library(tidyverse)
library(magrittr)
library(forcats)
library(snakecase)
loadData <- function(fileName = "train.csv", ...) {
file = paste("../input", fileName, sep="/")
data.table::fread(file, ...) %>%
as_tibble()
}
df = loadData()
unique(df$OffenseFormation)
table(df$OffenseFormation)
df %>%
mutate(OffenseFormation = fct_recode(OffenseFormation, missing = "")) %>%
select(OffenseFormation) %>%
table()
# df %<>% mutate(OffenseFormation = fct_recode(OffenseFormation, Missing = ""))
head(df$PlayerHeight)
df %>%
mutate(PlayerHeight = (as.numeric(str_extract(PlayerHeight, "[^-]+")) * 12) +
as.numeric(str_extract(PlayerHeight, "[^-]*$"))) %>%
select(PlayerHeight) %>%
head()
table(df$Stadium)
stadiumNames = unique(df$Stadium)
newNames = to_lower_camel_case(stadiumNames)
names(stadiumNames) = newNames
df %>%
mutate(
Stadium = as.factor(Stadium),
Stadium = fct_recode(Stadium, !!!stadiumNames)
) %>%
select(Stadium) %>%
table()
df %>%
mutate(
Stadium = as.factor(Stadium),
Stadium = fct_recode(Stadium, !!!stadiumNames),
Stadium = fct_collapse(Stadium,
attStadium = "atTStadium",
centuryLinkField = "centuryLink",
everBankField = "everbankField",
firstEnergyField = "firstEnergy",
losAngelesMemorialColiseum = "losAngelesMemorialColiseum",
mtBankStadium = c("mTBankStadium, mTStadium"),
mercedesBenzSuperdome = "mercedesBenzDome",
metLife = c("metLifeStadium", "metlifeStadium"),
nrgStadium = "nrg",
paulBrownStadium = "paulBrownStadium",
twickenhamStadium = "twickenham",
usBankStadium = "uSBankStadium"
)
) %>%
select(Stadium) %>%
table()
table(df$Location)
table(df$StadiumType)
outdoor = c('Outdoor', 'Outdoors', 'Cloudy', 'Heinz Field',
'Outdor', 'Ourdoor', 'Outside', 'Outddors',
'Outdoor Retr Roof-Open', 'Oudoor', 'Bowl')
indoorClosed = c('Indoors', 'Indoor', 'Indoor, Roof Closed', 'Indoor, Roof Closed',
'Retractable Roof', 'Retr. Roof-Closed', 'Retr. Roof - Closed',
'Retr. Roof Closed')
indoorOpen = c('Indoor, Open Roof', 'Open', 'Retr. Roof-Open', 'Retr. Roof - Open')
domeClosed = c('Dome', 'Domed, closed', 'Closed Dome', 'Domed', 'Dome, closed')
domeOpen = c('Domed, Open', 'Domed, open')
df %>%
mutate(StadiumType = fct_collapse(StadiumType,
outside = outdoor,
indoorClosed = indoorClosed,
indoorOpen = indoorOpen,
domeClosed = domeClosed,
domeOpen = domeOpen,
missing = ""
)) %>%
select(StadiumType) %>%
table()
table(df$Turf)
turfNames = unique(df$Turf)
newTurfNames = to_lower_camel_case(turfNames)
names(turfNames) = newTurfNames
newTurfNames
df %>%
mutate(
Turf = fct_recode(Turf, !!!turfNames),
Turf = fct_collapse(Turf,
grass = c("naturallGrass", "naturalGrass", "natural"),
artificial = "artifical",
ubuSpeedSeriesS5M = "ubuSportsSpeedS5M"
)
) %>%
select(Turf) %>%
table()
table(df$GameWeather)
rain = c('Rainy', 'Rain Chance 40%', 'Showers',
'Cloudy with periods of rain, thunder possible. Winds shifting to WNW, 10-20 mph.',
'Scattered Showers', 'Cloudy, Rain', 'Rain shower', 'Light Rain', 'Rain')
overcast = c('Party Cloudy', 'Cloudy, chance of rain',
'Coudy', 'Cloudy, 50% change of rain', 'Rain likely, temps in low 40s.',
'Cloudy and cold', 'Cloudy, fog started developing in 2nd quarter',
'Partly Clouidy', '30% Chance of Rain', 'Mostly Coudy', 'Cloudy and Cool',
'cloudy', 'Partly cloudy', 'Overcast', 'Hazy', 'Mostly cloudy', 'Mostly Cloudy',
'Partly Cloudy', 'Cloudy')
clear = c('Partly clear', 'Sunny and clear', 'Sun & clouds', 'Clear and Sunny',
'Sunny and cold', 'Sunny Skies', 'Clear and Cool', 'Clear and sunny',
'Sunny, highs to upper 80s', 'Mostly Sunny Skies', 'Cold',
'Clear and warm', 'Sunny and warm', 'Clear and cold', 'Mostly sunny',
'T: 51; H: 55; W: NW 10 mph', 'Clear Skies', 'Clear skies', 'Partly sunny',
'Fair', 'Partly Sunny', 'Mostly Sunny', 'Clear', 'Sunny', "Sunny, Windy")
snow = c('Heavy lake effect snow', 'Snow', 'Cloudy, light snow accumulating 1-3""')
indoor = c('N/A Indoor', 'Indoors', 'Indoor', 'N/A (Indoors)', 'Controlled Climate', "N/A")
df %>%
mutate(
GameWeather = fct_collapse(GameWeather,
rain = rain,
overcast = overcast,
clear = clear,
snow = snow,
indoor = indoor,
missing = ""
)
) %>%
select(GameWeather) %>%
table()
table(df$WindSpeed)
table(df$WindDirection)
df %>%
filter(WindDirection == "Calm") %>%
select(WindSpeed)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
# select(WindSpeed, WindDirection) %>%
select(WindDirection) %>%
table()
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
table(dfDirSpeed$WindSpeed)
df[df$WindSpeed %in% c("E", "SE", "SSW"),] = dfDirSpeed
table(df$WindSpeed)
table(df$WindDirection)
df[df$WindDirection == "Calm", ] = 0
df %>%
mutate(
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer()
) %>%
select(WindSpeed) %>%
table()
teamAbbreviations = c(BAL = "BLT", CLE = "CLV", ARI = "ARZ", HOU = "HST")
df %<>%
mutate(
OffenseFormation = fct_recode(OffenseFormation, missing = ""),
PlayerHeight = (as.numeric(str_extract(PlayerHeight, "[^-]+")) * 12) +
as.numeric(str_extract(PlayerHeight, "[^-]*$")),
StadiumType = fct_collapse(StadiumType,
outside = outdoor,
indoorClosed = indoorClosed,
indoorOpen = indoorOpen,
domeClosed = domeClosed,
domeOpen = domeOpen,
missing = ""),
Turf = fct_recode(Turf, !!!turfNames),
Turf = fct_collapse(Turf,
grass = c("naturallGrass", "naturalGrass", "natural"),
artificial = "artifical",
ubuSpeedSeriesS5M = "ubuSportsSpeedS5M"),
GameWeather = fct_collapse(GameWeather,
rain = rain,
overcast = overcast,
clear = clear,
snow = snow,
indoor = indoor,
missing = ""),
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer(),
PossessionTeam = fct_recode(PossessionTeam, !!!teamAbbreviations)
)
data.table::fwrite(df, file = "..\input\trainClean.csv")
data.table::fwrite(df, file = "../input/trainClean.csv")
library(knitr)
opts_chunk$set(echo = TRUE,
collapse = FALSE,
comment = "",
strip.white = TRUE,
warning = FALSE,
message = FALSE,
out.width = "70%",
fig.align = "center")
library(tidyverse)
library(magrittr)
library(forcats)
library(snakecase)  # slow as fuck, so use for factor names not dataset
loadData <- function(fileName = "train.csv", ...) {
file = paste("../input", fileName, sep="/")
data.table::fread(file, ...) %>%
as_tibble()
}
df = loadData()
unique(df$OffenseFormation)
table(df$OffenseFormation)
df %>%
mutate(OffenseFormation = fct_recode(OffenseFormation, missing = "")) %>%
select(OffenseFormation) %>%
table()
# df %<>% mutate(OffenseFormation = fct_recode(OffenseFormation, Missing = ""))
head(df$PlayerHeight)
df %>%
mutate(PlayerHeight = (as.numeric(str_extract(PlayerHeight, "[^-]+")) * 12) +
as.numeric(str_extract(PlayerHeight, "[^-]*$"))) %>%
select(PlayerHeight) %>%
head()
table(df$Stadium)
stadiumNames = unique(df$Stadium)
newNames = to_lower_camel_case(stadiumNames)
names(stadiumNames) = newNames
df %>%
mutate(
Stadium = as.factor(Stadium),
Stadium = fct_recode(Stadium, !!!stadiumNames)
) %>%
select(Stadium) %>%
table()
df %>%
mutate(
Stadium = as.factor(Stadium),
Stadium = fct_recode(Stadium, !!!stadiumNames),
Stadium = fct_collapse(Stadium,
attStadium = "atTStadium",
centuryLinkField = "centuryLink",
everBankField = "everbankField",
firstEnergyField = "firstEnergy",
losAngelesMemorialColiseum = "losAngelesMemorialColiseum",
mtBankStadium = c("mTBankStadium, mTStadium"),
mercedesBenzSuperdome = "mercedesBenzDome",
metLife = c("metLifeStadium", "metlifeStadium"),
nrgStadium = "nrg",
paulBrownStadium = "paulBrownStadium",
twickenhamStadium = "twickenham",
usBankStadium = "uSBankStadium"
)
) %>%
select(Stadium) %>%
table()
table(df$Location)
table(df$StadiumType)
outdoor = c('Outdoor', 'Outdoors', 'Cloudy', 'Heinz Field',
'Outdor', 'Ourdoor', 'Outside', 'Outddors',
'Outdoor Retr Roof-Open', 'Oudoor', 'Bowl')
indoorClosed = c('Indoors', 'Indoor', 'Indoor, Roof Closed', 'Indoor, Roof Closed',
'Retractable Roof', 'Retr. Roof-Closed', 'Retr. Roof - Closed',
'Retr. Roof Closed')
indoorOpen = c('Indoor, Open Roof', 'Open', 'Retr. Roof-Open', 'Retr. Roof - Open')
domeClosed = c('Dome', 'Domed, closed', 'Closed Dome', 'Domed', 'Dome, closed')
domeOpen = c('Domed, Open', 'Domed, open')
df %>%
mutate(StadiumType = fct_collapse(StadiumType,
outside = outdoor,
indoorClosed = indoorClosed,
indoorOpen = indoorOpen,
domeClosed = domeClosed,
domeOpen = domeOpen,
missing = ""
)) %>%
select(StadiumType) %>%
table()
table(df$Turf)
turfNames = unique(df$Turf)
newTurfNames = to_lower_camel_case(turfNames)
names(turfNames) = newTurfNames
newTurfNames
df %>%
mutate(
Turf = fct_recode(Turf, !!!turfNames),
Turf = fct_collapse(Turf,
grass = c("naturallGrass", "naturalGrass", "natural"),
artificial = "artifical",
ubuSpeedSeriesS5M = "ubuSportsSpeedS5M"
)
) %>%
select(Turf) %>%
table()
table(df$GameWeather)
rain = c('Rainy', 'Rain Chance 40%', 'Showers',
'Cloudy with periods of rain, thunder possible. Winds shifting to WNW, 10-20 mph.',
'Scattered Showers', 'Cloudy, Rain', 'Rain shower', 'Light Rain', 'Rain')
overcast = c('Party Cloudy', 'Cloudy, chance of rain',
'Coudy', 'Cloudy, 50% change of rain', 'Rain likely, temps in low 40s.',
'Cloudy and cold', 'Cloudy, fog started developing in 2nd quarter',
'Partly Clouidy', '30% Chance of Rain', 'Mostly Coudy', 'Cloudy and Cool',
'cloudy', 'Partly cloudy', 'Overcast', 'Hazy', 'Mostly cloudy', 'Mostly Cloudy',
'Partly Cloudy', 'Cloudy')
clear = c('Partly clear', 'Sunny and clear', 'Sun & clouds', 'Clear and Sunny',
'Sunny and cold', 'Sunny Skies', 'Clear and Cool', 'Clear and sunny',
'Sunny, highs to upper 80s', 'Mostly Sunny Skies', 'Cold',
'Clear and warm', 'Sunny and warm', 'Clear and cold', 'Mostly sunny',
'T: 51; H: 55; W: NW 10 mph', 'Clear Skies', 'Clear skies', 'Partly sunny',
'Fair', 'Partly Sunny', 'Mostly Sunny', 'Clear', 'Sunny', "Sunny, Windy")
snow = c('Heavy lake effect snow', 'Snow', 'Cloudy, light snow accumulating 1-3""')
indoor = c('N/A Indoor', 'Indoors', 'Indoor', 'N/A (Indoors)', 'Controlled Climate', "N/A")
df %>%
mutate(
GameWeather = fct_collapse(GameWeather,
rain = rain,
overcast = overcast,
clear = clear,
snow = snow,
indoor = indoor,
missing = ""
)
) %>%
select(GameWeather) %>%
table()
table(df$WindSpeed)
table(df$WindDirection)
df %>%
filter(WindDirection == "Calm") %>%
select(WindSpeed)
df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
# select(WindSpeed, WindDirection) %>%
select(WindDirection) %>%
table()
dfDirSpeed = df %>%
filter(WindSpeed %in% c("E", "SE", "SSW")) %>%
rename(WindDirection = WindSpeed, WindSpeed = WindDirection)
dfDirSpeed %>%
select(PlayId, WindSpeed, WindDirection)
table(dfDirSpeed$WindSpeed)
df[df$WindSpeed %in% c("E", "SE", "SSW"),] = dfDirSpeed
table(df$WindSpeed)
table(df$WindDirection)
df[df$WindDirection == "Calm", ] = 0
df %>%
mutate(
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer()
) %>%
select(WindSpeed) %>%
table()
teamAbbreviations = c(BAL = "BLT", CLE = "CLV", ARI = "ARZ", HOU = "HST")
df %<>%
mutate(
OffenseFormation = fct_recode(OffenseFormation, missing = ""),
PlayerHeight = (as.numeric(str_extract(PlayerHeight, "[^-]+")) * 12) +
as.numeric(str_extract(PlayerHeight, "[^-]*$")),
StadiumType = fct_collapse(StadiumType,
outside = outdoor,
indoorClosed = indoorClosed,
indoorOpen = indoorOpen,
domeClosed = domeClosed,
domeOpen = domeOpen,
missing = ""),
Turf = fct_recode(Turf, !!!turfNames),
Turf = fct_collapse(Turf,
grass = c("naturallGrass", "naturalGrass", "natural"),
artificial = "artifical",
ubuSpeedSeriesS5M = "ubuSportsSpeedS5M"),
GameWeather = fct_collapse(GameWeather,
rain = rain,
overcast = overcast,
clear = clear,
snow = snow,
indoor = indoor,
missing = ""),
WindSpeed = str_replace_all(WindSpeed, "[:alpha:]", "") %>%
str_extract("^[:digit:]+") %>%
as.integer(),
PossessionTeam = fct_recode(PossessionTeam, !!!teamAbbreviations)
) %>%
select(-Stadium, -Location)
data.table::fwrite(df, file = "../input/trainClean.csv")
dfClean = loadData("trainClean.csv")
colnames(dfClean)
library(knitr)
opts_chunk$set(echo = TRUE,
collapse = FALSE,
comment = "",
strip.white = TRUE,
warning = FALSE,
message = FALSE,
out.width = "70%",
fig.align = "center")
library(tidyverse)
library(magrittr)
library(modelr)  # for cv
# devtools::install_github("korydjohnson/rai")
library(rai)
loadData <- function(fileName = "train.csv", ...) {
file = paste("../input", fileName, sep="/")
data.table::fread(file, ...) %>%
as_tibble()
}
df = loadData("trainClean.csv")
install.packages("snakecase")
library(knitr)
opts_chunk$set(echo = TRUE,
cache = FALSE,
collapse = FALSE,
comment = "",
strip.white = TRUE,
warning = FALSE,
message = FALSE,
out.width = "70%",
fig.align = "center")
getwd()
getwd()
